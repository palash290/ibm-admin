<fieldset class="ct_white_bg">
    <div class="ct_form-card">
        <h4 class="ct_fs_24 ct_fw_700 mb-0 ">Policies</h4>
        <p class="mb-4 ct_text_op_6">Please upload your policiesÂ </p>
        <!-- <div class="row">
            <div class="col-md-12">
                <div class="form-group mb-4">
                    <div class="ct_upload_product_main ct_upload_product_main_180">
                        <svg width="33" height="33" viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M5.87174 22.0167C4.26376 20.9403 3.20508 19.1073 3.20508 17.027C3.20508 13.9023 5.59376 11.3354 8.64473 11.0528C9.26883 7.25653 12.5654 4.36035 16.5384 4.36035C20.5114 4.36035 23.808 7.25653 24.4321 11.0528C27.4831 11.3354 29.8717 13.9023 29.8717 17.027C29.8717 19.1073 28.8131 20.9403 27.2051 22.0167M11.2051 21.6937L16.5384 16.3604M16.5384 16.3604L21.8717 21.6937M16.5384 16.3604V28.3604"
                                stroke="#4880FF" stroke-width="2.66667" stroke-linecap="round" stroke-linejoin="round">
                            </path>
                        </svg>

                        <p class="text-center ct_fs_18 ct_text_op_07 mb-0">Upload your
                            CSV
                            here</p>
                        <small>Supported formats: CSV, XLSX</small>
                        <label for="ct_upload_product">
                            <input type="file" name="" id="ct_upload_product" class="d-none">
                            <div class="ct_browse_btn mt-3">
                                <span>Browse Files</span>
                            </div>
                        </label>
                    </div>

                    <div class="ct_multiple_img_div ct_custom_scroll d-none">
                        <div class="ct_uploaded_img123 position-relative ">

                            <div class="ct_uploaded_img_w">
                                <img src="assets/img/user_1.png" alt="">
                                <i class="fa-solid fa-xmark"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->

        <form [formGroup]="form">
            <div formArrayName="policies">
                <ng-container *ngFor="let policy of policies.controls; let i = index">
                    <div *ngIf="apiPeopleData[i]?.people_type == 'adult'" [formGroupName]="i" class="row mt-3">
                        <div class="col-md-12">
                            <div class="ct_case_select_card p-4 pb-0">
                                <h4 class="mb-0 ct_fs_20 mb-4 ct_fw_700">
                                    Policy #{{ i + 1 }} - {{ apiPeopleData[i]?.first_name }}
                                </h4>
                                <div class="row">

                                    <div class="col-md-6">
                                        <div class="form-group mb-4">
                                            <label class="mb-2 ct_fw_600">Minimum Recommended Life coverage</label>
                                            <div class="position-relative">
                                                <input formControlName="minimum_recommended_life_coverage" type="number"
                                                    class="form-control ct_input ct_input_ps_30" placeholder="0.00">
                                                <span class="ct_input_icon_left">$</span>
                                            </div>

                                            <div
                                                *ngIf="policy.get('minimum_recommended_life_coverage')?.touched && policy.get('minimum_recommended_life_coverage')?.invalid">
                                                <small class="text-danger">This field is required</small>
                                            </div>

                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group mb-4">
                                            <label class="mb-2 ct_fw_600">Insurance Carrier</label>
                                            <div class="position-relative">
                                                <input formControlName="insurance_carrier" type="text"
                                                    class="form-control ct_input ct_input_ps_30"
                                                    placeholder="Insurance Carrier">
                                                <!-- <span class="ct_input_icon_left">$</span> -->
                                            </div>
                                            <div
                                                *ngIf="policy.get('insurance_carrier')?.touched && policy.get('insurance_carrier')?.invalid">
                                                <small class="text-danger">This field is required</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group mb-4">
                                            <label class="mb-2 ct_fw_600">Policy Intrest Rate %</label>
                                            <input type="number" formControlName="policy_interest_rate"
                                                class="form-control ct_input" placeholder="Policy Intrest Rate" />
                                            <div
                                                *ngIf="policy.get('policy_interest_rate')?.touched && policy.get('policy_interest_rate')?.invalid">
                                                <small class="text-danger">This field is required</small>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <div class="form-group mb-4">
                                            <label class="mb-2 ct_fw_600">Upload CSV/XLS</label>
                                            <input type="file" (change)="onFileChange($event, i)"
                                                accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                                                class="form-control ct_input" />

                                            <div *ngIf="existingFileNames[i]" class="mt-1">
                                                <small class="text-success">Existing file: {{ existingFileNames[i]
                                                    }}</small>
                                            </div>

                                            <div *ngIf="submitted && !selectedFiles[i] && !existingFileNames[i]">
                                                <small class="text-danger">This field is required</small>
                                            </div>
                                        </div>
                                    </div>


                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </form>
    </div>
    <div class="mt-3">
        <a type="button" name="next" class=" ct_blue_btn float-end ms-2 ct_border_radius_5" (click)="submit()">Save
            & Next</a>
        <button class="previous action-button-previou ct_outline_btn float-end ct_border_radius_5"
            routerLink="/user/loan-calculator/final-totals">Back</button>
    </div>

</fieldset>

<!-- <input type="file" (change)="onFileChange($event)" accept=".csv" /> -->